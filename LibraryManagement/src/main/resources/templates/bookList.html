<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n l√Ω t√†i kho·∫£n</title>
    <link rel="stylesheet" th:href="@{/css/bookList.css}">
    <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>
<body>
	<!-- Sidebar -->
	<div th:replace="admin :: sidebar"></div>
	
	<!-- Form danh s√°ch -->
    <div class="container">
        <h2>Danh s√°ch th∆∞ vi·ªán</h2>

		<form th:action="@{/admin/search-book}" method="post" class="search-container">
			<input type="text" name="keyword" placeholder="Nh·∫≠p t√™n s√°ch ho·∫∑c t√™n t√°c gi·∫£ ...">
			<button type="submit" class="search-btn">üîç T√¨m ki·∫øm</button>
		</form>

		<table>
			<thead>
			<tr>
				<th>ID</th>
				<th>·∫¢nh</th>
				<th>T√™n s√°ch</th>
				<th>T√°c gi·∫£</th>
				<th>Th·ªÉ lo·∫°i</th>
				<th>S·ªë l∆∞·ª£ng</th>
				<th>S·ªë l∆∞·ª£ng m∆∞·ª£n</th>
				<th>S·ªë l∆∞·ª£ng h∆∞ h·∫°i</th> <!-- C·ªôt m·ªõi -->
				<th>S·ª≠a</th>
				<th>X√≥a</th>
			</tr>
			</thead>
			<tbody>
			<tr th:each="book : ${books}">
				<td th:text="${book.bookId}"></td>
				<td>
					<img th:src="@{/images/book_images/{img}(img=${book.bookImage})}" alt="·∫¢nh b√¨a" width="80">
				</td>
				<td th:text="${book.bookName}"></td>
				<td>
                <span th:each="author, iterStat : ${book.authors}">
                    <span th:text="${author.authorName}"></span>
                    <span th:if="${!iterStat.last}">, </span>
                </span>
				</td>
				<td th:text="${book.category.categoryName}"></td>
				<td th:text="${book.amount}"></td>
				<td th:text="${book.borrowCount}"></td>
				<td th:text="${book.isDamaged}"></td> <!-- Hi·ªÉn th·ªã s·ªë l∆∞·ª£ng s√°ch h∆∞ h·∫°i -->
				<td>
					<form th:action="@{/admin/edit-book/{id}(id=${book.bookId})}" method="post">
						<button type="submit" class="btn btn-edit">S·ª≠a</button>
					</form>
				</td>
				<td>
					<form th:action="@{/admin/delete-book/{id}(id=${book.bookId})}" method="post" 
							class="deleteForm">
						<button type="submit" class="btn btn-remove">X√≥a</button>
					</form>
				</td>
			</tr>
			</tbody>
		</table>

    </div>
</body>

<!-- Import th∆∞ vi·ªán SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".deleteForm").forEach(form => {
        form.addEventListener("submit", function (event) {
            event.preventDefault(); // NgƒÉn form g·ª≠i ngay l·∫≠p t·ª©c

            Swal.fire({
                title: "X√°c nh·∫≠n x√≥a s√°ch",
                text: "B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s√°ch n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "X√≥a",
                cancelButtonText: "H·ªßy"
            }).then((result) => {
                if (result.isConfirmed) {
                    form.submit(); // N·∫øu ng∆∞·ªùi d√πng b·∫•m X√≥a, g·ª≠i form
                }
            });
        });
    });
});
</script>
</html>